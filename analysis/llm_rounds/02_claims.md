# Round 2 权利要求书草案

1. 一种双数据源工业波形数据处理方法，其特征在于，包括：
接收离线文件源与在线网络源的工业波形数据；
基于统一字段模型对输入数据执行标准化建模；
按预设消息主题执行异步路由并由对应消费者处理；
将结构化数据与波形时序数据分层持久化；
通过服务接口返回查询结果与处理状态。

2. 根据权利要求1所述的方法，其特征在于，所述离线文件源包括TDMS波形文件与日志文件，所述在线网络源包括消息队列接入源。

3. 根据权利要求1所述的方法，其特征在于，所述统一字段模型至少包括shotNo、fileName、filePath、expectedDuration、actualDuration和status。

4. 根据权利要求1所述的方法，其特征在于，所述预设消息主题至少包括shot-metadata、wave-data、operation-log和plc-interlock。

5. 根据权利要求1所述的方法，其特征在于，所述方法支持单任务同步、批量同步和全量同步三种触发模式。

6. 根据权利要求1所述的方法，其特征在于，元数据、操作日志和PLC互锁日志分别写入关系型数据库中的对应表。

7. 根据权利要求1所述的方法，其特征在于，波形数据在持久化前执行压缩编码后写入时序数据库。

8. 根据权利要求7所述的方法，其特征在于，查询阶段对压缩波形数据执行解压处理并返回按炮号和通道组织的波形序列。

9. 根据权利要求1所述的方法，其特征在于，通道信息查询优先读取数据库通道表，数据库缺失时读取通道元数据文件。

10. 根据权利要求1所述的方法，其特征在于，所述方法包括主数据源可用性检测步骤，在主数据源不可用时切换至备用数据源。

11. 根据权利要求10所述的方法，其特征在于，在主数据源恢复可用后执行回退切换以恢复主链路服务。

12. 根据权利要求1所述的方法，其特征在于，处理状态和结果通过WebSocket通道周期推送至客户端，并通过REST接口提供查询与触发能力。

13. 一种双数据源工业波形数据处理系统，其特征在于，包括数据接入模块、标准化建模模块、消息路由模块、消费存储模块、查询服务模块和状态推送模块，所述各模块协同执行权利要求1至12任一项所述的方法。

14. 根据权利要求13所述的系统，其特征在于，所述数据接入模块包括主数据源单元、备用数据源单元和切换控制单元。

15. 根据权利要求13所述的系统，其特征在于，所述消息路由模块包括生产者单元和按主题分发的消费者单元。

16. 根据权利要求13所述的系统，其特征在于，所述消费存储模块包括关系型存储单元和时序存储单元。

17. 根据权利要求13所述的系统，其特征在于，所述查询服务模块包括数据查询接口单元和同步触发接口单元。

18. 一种计算机设备，其特征在于，包括处理器和存储器，所述存储器中存储有程序，所述程序被所述处理器执行时实现权利要求1至12任一项所述的方法。

19. 一种计算机可读存储介质，其特征在于，其上存储有程序，所述程序被处理器执行时实现权利要求1至12任一项所述的方法。

20. 一种计算机程序产品，其特征在于，包括程序指令，所述程序指令被处理器执行时实现权利要求1至12任一项所述的方法。
