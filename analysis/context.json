{
  "repo_name": "repo",
  "repo_path": "C:\\Users\\jesus\\codex_test\\repo2patent\\work\\repo",
  "file_extension_counts": {
    ".md": 5,
    ".py": 5,
    ".xml": 1,
    ".json": 7,
    ".tdms": 14,
    ".tdms_index": 8,
    ".txt": 8,
    "": 1,
    ".yml": 3,
    ".sh": 1,
    ".java": 39,
    ".html": 1
  },
  "languages_by_extension_top10": [
    ".java",
    ".py",
    ".tdms",
    ".tdms_index",
    ".txt",
    ".json",
    ".md",
    ".yml",
    ".html",
    ".sh"
  ],
  "readme_excerpt": "# æ³¢å½¢æ•°æ®å±•ç¤ºç³»ç»Ÿ\n\n**é¡¹ç›®ç‰ˆæœ¬**: 1.0.0  \n**æœ€åæ›´æ–°**: 2026å¹´1æœˆ11æ—¥  \n**æ„å»ºçŠ¶æ€**: âœ… æ„å»ºæˆåŠŸ | ğŸ“¦ è¿è¡Œä¸­\n\n## ç³»ç»Ÿç®€ä»‹\n\nä¸€å¥—å®Œæ•´çš„**æ³¢å½¢æ•°æ®é‡‡é›†ã€å¤„ç†ã€å­˜å‚¨ä¸å±•ç¤º**ç³»ç»Ÿï¼Œæ”¯æŒTDMSæ–‡ä»¶å’Œç½‘ç»œä¸¤ç§æ•°æ®æºã€‚åŒ…å«ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š\n\n- ğŸ“Š **å®æ—¶æ³¢å½¢å±•ç¤º**ï¼šEChartså›¾è¡¨ï¼ŒåŠ¨æ€æ˜¾ç¤ºé‡‡æ ·ç‚¹æ•°é‡\n- ğŸ”„ **åŒæ•°æ®æº**ï¼šæœ¬åœ°æ–‡ä»¶ (FileDataSource) / Kafkaç½‘ç»œ (NetworkDataSource)ï¼Œæ”¯æŒè¿è¡Œæ—¶åˆ‡æ¢ä¸ä¸»å¤‡å›é€€\n- ğŸ“¢ **Kafkaæ•°æ®ç®¡é“**ï¼šæ–‡ä»¶ â†’ Kafka â†’ MySQL/InfluxDB â†’ å‰ç«¯ï¼Œå®ç°å¼‚æ­¥è§£è€¦\n- ğŸ’¾ **æ··åˆå­˜å‚¨**ï¼š\n  - MySQL: å…ƒæ•°æ®ã€æ“ä½œæ—¥å¿—ã€PLCäº’é” (ç»“æ„åŒ–æ•°æ®)\n  - InfluxDB: æ³¢å½¢æ—¶åºæ•°æ® (é«˜æ•ˆæ—¶åºæŸ¥è¯¢)\n- ğŸŒ **REST API + WebSocket**ï¼šå®Œæ•´çš„æ•°æ®æ¥å£ + å®æ—¶æ¨é€\n- ğŸ“‹ **è¾…åŠ©å·¥å…·**ï¼šPythonè„šæœ¬è¿›è¡Œé€šé“æå–ã€æ•°æ®å‘å¸ƒã€å†’çƒŸæµ‹è¯•\n\n## æ ¸å¿ƒèƒ½åŠ›\n\n- âœ… **æ–‡ä»¶/ç½‘ç»œåŒæ•°æ®æº**ï¼šè¿è¡Œæ—¶å¯åˆ‡æ¢ï¼Œæ”¯æŒä¸»å¤‡å›é€€ (fallback)\n- âœ… **Kafkaæ•°æ®ç®¡é“**ï¼šæ–‡ä»¶ â†’ Kafka â†’ DataConsumer â†’ MySQL/InfluxDB\n- âœ… **REST API**ï¼šç‚®å·åˆ—è¡¨ã€å…ƒæ•°æ®ã€æ³¢å½¢æ•°æ®ã€æ“ä½œæ—¥å¿—ã€PLCäº’é”ã€æ•°æ®æºçŠ¶æ€\n- âœ… **WebSocketæ¨é€**ï¼šå®æ—¶æ•°æ®æ›´æ–°æ¨é€\n- âœ… **Web UI**ï¼šEChartsæ³¢å½¢å±•ç¤ºã€ç‚®å·é€‰æ‹©ã€é€šé“åˆ—è¡¨ã€æ“ä½œæ—¥å¿—æ—¶é—´çº¿\n- âœ… **æ•°æ®é‡‡æ ·ç»Ÿè®¡**ï¼šæ³¢å½¢å›¾è¡¨æ ‡é¢˜æ˜¾ç¤ºé‡‡æ ·ç‚¹æ•°é‡\n- âœ… **å®Œæ•´çš„è¾…åŠ©å·¥å…·é“¾**ï¼šé€šé“æå–ã€æ³¢å½¢è¯»å–ã€Kafkaæ•°æ®å‘å¸ƒã€å†’çƒŸæµ‹è¯•\n\n## è¿è¡Œæ¨¡å¼ä¸æ•°æ®æµ\n\n### æ•°æ®æºç›´è¯»æ¨¡å¼ (`/api/data/*`)\n- ç›´æ¥ä»ä¸»æ•°æ®æºè¯»å–ï¼ˆ`app.data.source.primary=file|network`ï¼‰\n- å½“ `app.data.source.fallback=true` æ—¶ï¼Œè‡ªåŠ¨åˆå¹¶å¤‡ç”¨æ•°æ®æºç»“æœ\n- é€‚ç”¨äº: ç‚®å·åˆ—è¡¨ã€å…ƒæ•°æ®ã€æ³¢å½¢ã€é€šé“ã€æ—¥å¿—\n\n### Kafkaæ•°æ®ç®¡é“æ¨¡å¼ (`/api/kafka/sync/*`)\n- æ–‡ä»¶ â†’ Kafka â†’ DataConsumer â†’ MySQL/InfluxDB å…¨é“¾è·¯åŒæ­¥\n- æä¾› `/api/kafka/sync/shot?shotNo=1` ç­‰ç«¯ç‚¹è§¦å‘å¯¼å…¥\n- åŒæ­¥å®Œæˆåé€šè¿‡ `/api/database` æˆ– `/api/hybrid` æŸ¥è¯¢æ•°æ®åº“\n\n### æ··åˆæŸ¥è¯¢æ¨¡å¼ (`/api/hybrid/*`)\n- ä»MySQLæŸ¥è¯¢å…ƒæ•°æ®ã€æ“ä½œæ—¥å¿—ã€PLCäº’é”\n- ä»InfluxDBæŸ¥è¯¢æ³¢å½¢æ—¶åºæ•°æ®\n- é€‚ç”¨äº: é«˜æ€§èƒ½æ³¢å½¢å±•ç¤ºã€æ—¶åºåˆ†æ\n\n**æ³¨æ„**ï¼š\n- Kafkaç½‘ç»œæ¨¡å¼éœ€è¦Kafkaé›†ç¾¤è¿è¡Œï¼Œå¯ç”¨ `docker-compose` å¿«é€Ÿå¯åŠ¨\n- InfluxDBé»˜è®¤å¼€å¯å†™å…¥ (`app.influxdb.enabled=true`)ï¼Œæœªéƒ¨ç½²æ—¶è¯·ç¦ç”¨æˆ–é…ç½®æ­£ç¡®token\n\n## é¡¹ç›®ç»“æ„\n\n```\n.\nâ”œâ”€â”€ src/main/java/com/example/kafka/        # âœ… æ ¸å¿ƒåç«¯ä»£ç \nâ”‚   â”œâ”€â”€ KafkaDemoApplication.java            # Spring Boot å¯åŠ¨ç±»\nâ”‚   â”œâ”€â”€ config/                              # é…ç½®å±‚\nâ”‚   â”‚   â”œâ”€â”€ KafkaConfig.java                 # Kafkaé…ç½®\nâ”‚   â”‚   â”œâ”€â”€ WebSocketConfig.java             # WebSocketé…ç½®\nâ”‚   â”‚   â””â”€â”€ InfluxDBConfig.java              # InfluxDBé…ç½®\nâ”‚   â”‚\nâ”‚   â”œâ”€â”€ controller/                          # æ§åˆ¶å™¨å±‚ (REST API)\nâ”‚   â”‚   â”œâ”€â”€ DataController.java              # æ•°æ®æºç›´è¯» API (/api/data/*)\nâ”‚   â”‚   â”œâ”€â”€ KafkaController.java             # Kafkaç®¡é“ API (/api/kafka/*)\nâ”‚   â”‚   â”œâ”€â”€ DatabaseController.java          # æ•°æ®åº“æŸ¥è¯¢ API (/api/database/*)\nâ”‚   â”‚   â”œâ”€â”€ HybridDataController.java        # æ··åˆæŸ¥è¯¢ API (/api/hybrid/*) - MySQL+InfluxDB\nâ”‚   â”‚   â”œâ”€â”€ InfluxDBMaintenanceController.java # InfluxDBç»´æŠ¤æ¥å£\nâ”‚   â”‚   â””â”€â”€ WebSocketController.java         # WebSocketç«¯ç‚¹\nâ”‚   â”‚\nâ”‚   â”œâ”€â”€ service/                             # æœåŠ¡å±‚\nâ”‚   â”‚   â”œâ”€â”€ DataService.java                 # ä¸»/å¤‡æ•°æ®æºç®¡ç†ä¸åˆ‡æ¢\nâ”‚   â”‚   â”œâ”€â”€ DataPipelineService.java         # æ–‡ä»¶â†’Kafkaâ†’DBåŒæ­¥ç®¡é“\nâ”‚   â”‚   â”œâ”€â”€ DataQueryService.java            # æ•°æ®åº“é€šç”¨æŸ¥è¯¢æœåŠ¡\nâ”‚   â”‚   â”œâ”€â”€ InfluxDBService.java             # InfluxDBæ—¶åºæ•°æ®æœåŠ¡\nâ”‚   â”‚   â”œâ”€â”€ MessageProducer.java             # Kafkaç”Ÿäº§è€…\nâ”‚   â”‚   â”œâ”€â”€ MessageConsumer.java             # Kafkaæ¶ˆè´¹è€…\nâ”‚   â”‚   â””â”€â”€ InfluxDBCleanupService.java      # InfluxDBæ¸…ç†ç»´æŠ¤\nâ”‚   â”‚\nâ”‚   â”œâ”€â”€ datasource/                          # æ•°æ®æºå®ç° (ç­–ç•¥æ¨¡å¼)\nâ”‚   â”‚   â”œâ”€â”€ DataSource.java                  # æ¥å£å®šä¹‰\nâ”‚   â”‚   â”œâ”€â”€ FileDataSource.java              # æœ¬åœ°æ–‡ä»¶æº - è¯»å–TDMS/æ—¥å¿—/PLC\nâ”‚   â”‚   â””â”€â”€ NetworkDataSource.java           # ç½‘ç»œæº - Kafkaæ¶ˆè´¹\nâ”‚   â”‚\nâ”‚   â”œâ”€â”€ ingest/                              # æ•°æ®é‡‡é›†å±‚\nâ”‚   â”‚   â”œâ”€â”€ FileDataReader.java              # æ–‡ä»¶è¯»å–å™¨\nâ”‚   â”‚   â””â”€â”€ NetworkDataReceiver.java         # ç½‘ç»œæ¥æ”¶å™¨\nâ”‚   â”‚\nâ”‚   â”œâ”€â”€ producer/                            # Kafkaç”Ÿäº§è€…\nâ”‚   â”‚   â””â”€â”€ DataProducer.java                # æ•°æ®ç”Ÿäº§è€…å®ç°\nâ”‚   â”‚\nâ”‚   â”œâ”€â”€ consumer/                            # Kafkaæ¶ˆè´¹è€… (ç›‘å¬å™¨)\nâ”‚   â”‚   â””â”€â”€ DataConsumer.java                # æ¶ˆè´¹è€… - è´Ÿè´£æŒä¹…åŒ–åˆ°MySQL/InfluxDB\nâ”‚   â”‚\nâ”‚   â”œâ”€â”€ entity/                              # æ•°æ®åº“å®ä½“ (JPA)\nâ”‚   â”‚   â”œâ”€â”€ ShotMetadataEntity.java          # ç‚®å·å…ƒæ•°æ®è¡¨\nâ”‚   â”‚   â”œâ”€â”€ WaveDataEntity.java              # æ³¢å½¢æ•°æ®è¡¨\nâ”‚   â”‚   â”œâ”€â”€ OperationLogEntity.java          # æ“ä½œæ—¥å¿—è¡¨\nâ”‚   â”‚   â”œâ”€â”€ PlcInterlockEntity.java          # PLCäº’é”è¡¨\nâ”‚   â”‚   â””â”€â”€ ChannelEntity.java               # é€šé“å…ƒæ•°æ®è¡¨\nâ”‚   â”‚\nâ”‚   â”œâ”€â”€ model/                               # æ•°æ®ä¼ è¾“å¯¹è±¡ (DTO)\nâ”‚   â”‚   â”œâ”€â”€ ShotMetadata.java                # ç‚®å·å…ƒæ•°æ®\nâ”‚   â”‚   â”œâ”€â”€ WaveData.java                    # æ³¢å½¢æ•°æ®\nâ”‚   â”‚   â”œâ”€â”€ OperationLog.java                # æ“ä½œæ—¥å¿—\nâ”‚   â”‚   â””â”€â”€ PlcInterlock.java                # PLCäº’é”\nâ”‚   â”‚\nâ”‚   â””â”€â”€ repository/                          # æ•°æ®è®¿é—®å±‚ (Spring Data JPA)\nâ”‚       â”œâ”€â”€ ShotMetadataRepository.java\nâ”‚       â”œâ”€â”€ WaveDataRepository.java\nâ”‚       â”œâ”€â”€ OperationLogRepository.java\nâ”‚       â”œâ”€â”€ PlcInterlockRepository.java\nâ”‚       â””â”€â”€ ChannelRepository.java\nâ”‚\nâ”œâ”€â”€ src/main/resources/                      # âœ… é…ç½®ä¸é™æ€èµ„æº\nâ”‚   â”œâ”€â”€ application.yml                      # åº”ç”¨ä¸»é…ç½® (æ•°æ®æº/Kafka/InfluxDB)\nâ”‚   â”œâ”€â”€ application-mysql.yml                # MySQLç‰¹å®šé…ç½®\nâ”‚   â”œâ”€â”€ static/index.html                    # å‰ç«¯Web UI - æ³¢å½¢å±•ç¤ºã€é€šé“é€‰æ‹©ã€æ—¶é—´çº¿\nâ”‚   â””â”€â”€ static/css|js                        # å‰ç«¯èµ„æº\nâ”‚\nâ”œâ”€â”€ data/                                    # âœ… æœ¬åœ°æ•°æ®æ–‡ä»¶\nâ”‚   â”œâ”€â”€ TUBE/                                # TDMSæ³¢å½¢æ–‡ä»¶ (æŒ‰ç‚®å·åˆ†ç»„)\nâ”‚   â”‚   â”œâ”€â”€ 1/  (1_Tube.tdms, 1_Water.tdms)\nâ”‚   â”‚   â”œâ”€â”€ 2/  â””â”€ ...\nâ”‚   â”‚   â””â”€â”€ ...\nâ”‚   â”œâ”€â”€ TUBE_logs/                           # æ“ä½œæ—¥å¿—æ–‡ä»¶ (æŒ‰ç‚®å·åˆ†ç»„)\nâ”‚   â”œâ”€â”€ PLC_logs/                            # PLCäº’é”æ—¥å¿—æ–‡ä»¶\nâ”‚   â””â”€â”€ channels/                            # é€šé“å…ƒæ•°æ® (JSON, extract_channels.pyç”Ÿæˆ)\nâ”‚       â”œâ”€â”€ channels_1.json\nâ”‚       â”œâ”€â”€ channels_2.json\nâ”‚       â””â”€â”€ ...\nâ”‚\nâ”œâ”€â”€ docker/                                  # âœ… Dockeré…ç½®\nâ”‚   â”œâ”€â”€ docker-compose.yml                   # ä¸€é”®å¯åŠ¨ Kafka(3èŠ‚ç‚¹) + InfluxDB + MySQL\nâ”‚   â””â”€â”€ data/                                # Dockerå®¹å™¨çš„æŒä¹…åŒ–æ•°æ®\nâ”‚\nâ”œâ”€â”€ scripts/                                 # âœ… å·¥å…·è„šæœ¬\nâ”‚   â””â”€â”€ projectctl.sh                        # é¡¹ç›®å…¨é‡ç®¡ç†è„šæœ¬ (å¯åŠ¨/åœæ­¢/é‡å¯/çŠ¶æ€)\nâ”‚\nâ”œâ”€â”€ pom.xml                                  # Mavené…ç½®\nâ”œâ”€â”€ ARCHITECTURE.md                          # âœ… æ¶æ„è®¾è®¡æ–‡æ¡£\nâ”œâ”€â”€ README.md                                # æœ¬æ–‡ä»¶\nâ””â”€â”€ ...\n```\n\n\n## è¿è¡Œä¾èµ–\n\n| ä¾èµ– | ç‰ˆæœ¬ | è¯´æ˜ |\n|------|------|------|\n| **JDK** | 17+ | âœ… å·²å®‰è£… (Java 17.0.17) |\n| **Maven** | 3.6+ | âœ… é¡¹ç›®ä¾èµ–ç®¡ç† |\n| **MySQL** | 8.0+ | âœ… å…³ç³»å‹æ•°æ®åº“ (localhost:3306) |\n| **InfluxDB** | 2.7+ | âœ… æ—¶åºæ•°æ®åº“ (localhost:8086) |\n| **Kafka** | 3.x (Confluent 8.1.1) | âœ… æ¶ˆæ¯é˜Ÿåˆ— (3èŠ‚ç‚¹é«˜å¯ç”¨) |\n| **Docker** | 20.10+ | âœ… å®¹å™¨åŒ–è¿è¡Œ |\n| **Docker Compose** | 1.29+ | âœ… å¿«é€Ÿå¯åŠ¨ä¾èµ–æœåŠ¡ |\n| **Python** | 3.8+ | âš ï¸ å¯é€‰ (æ•°æ®å¤„ç†è„šæœ¬) |\n\n### Pythonä¾èµ–åŒ… (å¯é€‰)\n```bash\npip install nptdms kafka-python influxdb-client\n```\nç”¨äºè¿è¡Œï¼š\n- `extract_channels.py` - ä»TDMSæå–é€šé“å…ƒæ•°æ®\n- `read_wave_data.py` - è¯»å–TDMSæ³¢å½¢\n- `data_publisher.py` - å‘é€æ•°æ®åˆ°Kafka\n\n## å¿«é€Ÿå¼€å§‹\n\n### 1ï¸âƒ£ å¯åŠ¨åŸºç¡€è®¾æ–½ (Kafka + MySQL + InfluxDB)\n\n```bash\ncd docker\nexport CLUSTER_ID=$(uuidgen)  # ç”ŸæˆKafkaé›†ç¾¤ID\nexport MYSQL_ROOT_PASSWORD=devroot\nexport MYSQL_DATABASE=wavedb\nexport MYSQL_USER=wavedb\nexport MYSQL_PASSWORD=wavedb123\n\ndocker compose up -d\n```\n\n**æ£€æŸ¥çŠ¶æ€**ï¼š\n```bash\ndocker compose ps\n# åº”çœ‹åˆ°: kafka1, kafka2, kafka3, kafka-ui, mysql, influxdb å‡ä¸º Up\n```\n\n### 2ï¸âƒ£ ç¼–è¯‘é¡¹ç›®\n\n```bash\nmvn clean package -DskipTests\n# ç”Ÿæˆ target/kafka-demo-1.0.0.jar\n```\n\n### 3ï¸âƒ£ å¯åŠ¨åº”ç”¨\n\n**æ–‡ä»¶æ•°æ®æºæ¨¡å¼ (é»˜è®¤)**ï¼š\n```bash\njava -jar target/kafka-demo-1.0.0.jar \\\n  --app.data.source.primary=file \\\n  --spring.profiles.active=dev\n```\n\n**ç½‘ç»œæ•°æ®æºæ¨¡å¼ (Kafka)**ï¼š\n```bash\njava -jar target/kafka-demo-1.0.0.jar \\\n  --app.data.source.primary=network \\\n  --spring.profiles.active=dev\n```\n\næˆ–ä½¿ç”¨åå°è¿è¡Œè„šæœ¬ï¼š\n```bash\nnohup java -jar target/kafka-demo-1.0.0.jar > logs/app.log 2>&1 &\n```\n\n### 4ï¸âƒ£ è®¿é—®åº”ç”¨\n\n| æœåŠ¡ | URL | è¯´æ˜ |\n|------|-----|------|\n| **Web UI** | http://localhost:8080 | æ³¢å½¢å±•ç¤ºã€æ•°æ®æŸ¥è¯¢ |\n| **Kafka UI** | http://localhost:18080 | Kafkaé›†ç¾¤å¯è§†åŒ–ç®¡ç† |\n| **InfluxDB UI** | http://localhost:8086 | æ—¶åºæ•°æ®åº“ç®¡ç† |\n\n\n## ğŸ“š APIæ¥å£é€ŸæŸ¥\n\n### ğŸ“Š æ•°æ®æºç›´è¯» (`/api/data/*`)\nç›´æ¥ä»é…ç½®çš„ä¸»æ•°æ®æºè¯»å–ï¼Œæ”¯æŒfallbackåˆå¹¶å¤‡ç”¨æºç»“æœ\n\n| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |\n|------|------|------|\n| GET | `/api/data/shots` | è·å–æ‰€æœ‰ç‚®å· |\n| GET | `/api/data/shots/{shotNo}/metadata` | ç‚®å·å…ƒæ•°æ® |\n| GET | `/api/data/shots/{shotNo}/complete` | å…ƒæ•°æ®+æ³¢å½¢+æ—¥å¿— |\n| GET | `/api/data/shots/{shotNo}/channels` | é€šé“åˆ—è¡¨ |\n| GET | `/api/data/shots/{shotNo}/logs/operation` | æ“ä½œæ—¥å¿— |\n| GET | `/api/data/shots/{shotNo}/logs/plc` | PLCäº’é” |\n\n### ğŸ“¢ Kafkaæ•°æ®ç®¡é“ (`/api/kafka/*`)\nè§¦å‘æ–‡ä»¶â†’Kafkaâ†’æ•°æ®åº“çš„å…¨é“¾è·¯åŒæ­¥\n\n| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |\n|------|------|------|\n| GET | `/api/kafka/health` | å¥åº·æ£€æŸ¥ |\n| GET | `/api/kafka/sync/shot?shotNo=1` | åŒæ­¥å•ä¸ªç‚®å· |\n| POST | `/api/kafka/sync/batch?shotNos=1,2,3` | æ‰¹é‡åŒæ­¥ |\n| POST | `/api/kafka/sync/all` | å…¨é‡åŒæ­¥æ‰€æœ‰ç‚®å· |\n\n### ğŸ’¾ æ•°æ®åº“æŸ¥è¯¢ (`/api/database/*`)\nä»MySQLæŸ¥è¯¢å„ç±»æ•°æ®\n\n| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |\n|------|------|------|\n| GET | `/api/database/stats` | æ•°æ®ç»Ÿè®¡ |\n| GET | `/api/database/metadata?shotNo=1` | å…ƒæ•°æ®æŸ¥è¯¢ |\n| GET | `/api/database/logs?shotNo=1` | æ—¥å¿—æŸ¥è¯¢ |\n\n### ğŸŒ æ··åˆæŸ¥è¯¢ (`/api/hybrid/*`)\nMySQL + InfluxDBç»„åˆæŸ¥è¯¢ï¼Œé«˜æ€§èƒ½æ³¢å½¢å±•ç¤º\n\n| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |\n|------|------|------|\n| GET | `/api/hybrid/shots` | ç‚®å·åˆ—è¡¨ |\n| GET | `/api/hybrid/shot/{shotNo}` | å…ƒæ•°æ®+é€šé“ |\n| GET | `/api/hybrid/waveform?shotNo=1&channelName=InPower` | æ³¢å½¢æ•°æ® (InfluxDB) |\n| GET | `/api/hybrid/timeline/{shotNo}` | æ“ä½œæ—¥å¿—æ—¶é—´çº¿ |\n\n### ğŸ”Œ WebSocketå®æ—¶æ¨é€\n- ç«¯ç‚¹ï¼š`ws://localhost:8080/ws`\n- è®¢é˜…ï¼š`/topic/shots`ã€`/topic/shot/{shotNo}` ç­‰\n\n### APIä½¿ç”¨ç¤ºä¾‹\n\n```bash\n# è·å–æ‰€æœ‰ç‚®å·\ncurl http://localhost:8080/api/data/shots\n# è¾“å‡º: [1,2,3,4,5,6,176]\n\n# è·å–ç‚®å·1çš„å…ƒæ•°æ®\ncurl http://localhost:8080/api/data/shots/1/metadata | python -m json.tool\n\n# è·å–ç‚®å·1ã€é€šé“InPowerçš„æ³¢å½¢ (ä»InfluxDB)\ncurl 'http://localhost:8080/api/hybrid/waveform?shotNo=1&channelName=InPower'\n\n# åŒæ­¥ç‚®å·1åˆ°æ•°æ®åº“\ncurl 'http://localhost:8080/api/kafka/sync/shot?shotNo=1'\n\n# è·å–ç‚®å·1çš„æ“ä½œæ—¥å¿—æ—¶é—´çº¿\ncurl 'http://localhost:8080/api/hybrid/timeline/1'\n```\n\n## ğŸ› ï¸ æ•°æ®å‡†å¤‡ä¸è¾…åŠ©è„šæœ¬\n\n| è„šæœ¬ | ç”¨é€” | è¯´æ˜ |\n|------|------|------|\n| `extract_channels.py` | é€šé“å…ƒæ•°æ®æå– | æ‰«æTDMSç”Ÿæˆ `channels/channels_*.json` |\n| `read_wave_data.py` | æ³¢å½¢è¯»å– | è¢«FileDataSourceè°ƒç”¨ï¼Œè§£æTDMSæ³¢å½¢ |\n| `data_publisher.py` | æ•°æ®å‘å¸ƒ | å°†æ–‡ä»¶æ•°æ®å‘é€åˆ°Kafkaï¼Œæµ‹è¯•ç½‘ç»œæº |\n| `run_tests.sh` | å†’çƒŸæµ‹è¯• | ç¼–è¯‘â†’å¯åŠ¨â†’APIæµ‹è¯• |\n\n**é€šé“å…ƒæ•°æ®å¤„ç†æµç¨‹**ï¼š\n1. é¦–å…ˆè¿è¡Œ `python extract_channels.py --all` ç”Ÿæˆ `channels/*.json`\n2. `DataConsumer` æ¶ˆè´¹ wave-data æ—¶å†™å…¥æ•°æ®åº“ `channels` è¡¨\n3. `FileDataSource.getChannelNames()` ä¼˜å…ˆè¯»æ•°æ®åº“ï¼Œå›é€€åˆ°JSONï¼Œæœ€åä½¿ç”¨é»˜è®¤é€šé“\n\n## âš™ï¸ ä¸»è¦é…ç½®è¯´æ˜\n\nç¼–è¾‘ `src/main/resources/application.yml`ï¼š\n\n```yaml\napp:\n  data:\n    tube.path: data/TUBE                    # TDMSæ³¢å½¢æ–‡ä»¶è·¯å¾„\n    logs.path: data/TUBE_logs               # æ“ä½œæ—¥å¿—è·¯å¾„\n    plc.path: data/PLC_logs                 # PLCäº’é”è·¯å¾„\n    channels.path: channels/                # é€šé“å…ƒæ•°æ®è·¯å¾„\n    source:\n      primary: file                         # ä¸»æ•°æ®æº: file / network\n      fallback: true                        # å¯ç”¨å¤‡ç”¨æ•°æ®æºè‡ªåŠ¨åˆå¹¶\n\n  kafka:\n    bootstrap-servers: localhost:19092,localhost:29092,localhost:39092\n    topic:\n      metadata: shot-metadata\n      wavedata: wave-data\n      operation: operation-log\n      plc: plc-interlock\n    group-id: data-consumer-group-v2\n\n  influxdb:\n    enabled: true                           # å¯ç”¨InfluxDBå†™å…¥\n    url: http://localhost:8086\n    token: my-super-secret-token\n    org: wavedata\n    bucket: waveforms\n\n  network:\n    enabled: false                          # TCPæ¥æ”¶å™¨å¼€å…³\n    port: 9999\n\nspring:\n  datasource:\n    url: jdbc:mysql://localhost:3306/wavedb?useUnicode=true&characterEncoding=utf-8&serverTimezone=Asia/Shanghai\n    driver-class-name: com.mysql.cj.jdbc.Driver\n    username: root\n    password: devroot\n\n  jpa:\n    hibernate:\n      ddl-auto: update                      # è‡ªåŠ¨åˆ›å»º/æ›´æ–°è¡¨\n\nserver:\n  port: 8080\n```\n\n## ğŸ§ª æµ‹è¯•\n\n**è‡ªåŠ¨åŒ–æµ‹è¯•**ï¼š\n```bash\n./run_tests.sh\n```\nä¼šè‡ªåŠ¨ï¼š\n1. æ¸…ç†ç¼–è¯‘äº§ç‰©\n2. ç¼–è¯‘é¡¹ç›®\n3. å¯åŠ¨åº”ç”¨\n4. è°ƒç”¨æ ¸å¿ƒAPIè¿›è¡Œå†’çƒŸæµ‹è¯•\n5. æŸ¥çœ‹æ—¥å¿—éªŒè¯åŠŸèƒ½\n\n**æ‰‹åŠ¨æµ‹è¯•ç¤ºä¾‹**ï¼š\n```bash\n# æ£€æŸ¥åº”ç”¨æ˜¯å¦è¿è¡Œ\ncurl http://localhost:8080/api/data/shots\n\n# éªŒè¯Kafkaç®¡é“\ncurl -X POST http://localhost:8080/api/kafka/sync/all\n\n# æ£€æŸ¥InfluxDBæ•°æ®\ncurl http://localhost:8080/api/hybrid/shots\n```\n\n## â“ å¸¸è§é—®é¢˜ & è§£å†³æ–¹æ¡ˆ\n\n| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |\n|------|------|---------|\n| **é€šé“åˆ—è¡¨ä¸ºç©º** | æœªç”Ÿæˆé€šé“å…ƒæ•°æ® | è¿è¡Œ `python extract_channels.py --all` |\n| **æ•°æ®åº“è¿æ¥å¤±è´¥** | MySQLæœªå¯åŠ¨æˆ–å‡­è¯é”™è¯¯ | æ£€æŸ¥ `docker compose ps` æˆ–æ›´æ–° `application.yml` |\n| **æ³¢å½¢æ•°æ®ä¸ºç©º** | InfluxDBæœªå¯ç”¨æˆ–æœªåŒæ­¥æ•°æ® | è¿è¡Œ `/api/kafka/sync/all` åŒæ­¥æ•°æ® |\n| **åˆ‡æ¢æ•°æ®æºå¤±è´¥** | å¤‡ç”¨æ•°æ®æºä¸å¯ç”¨ | ç¡®ä¿Kafkaé›†ç¾¤è¿è¡Œ (docker compose) |\n| **é‡‡æ ·ç‚¹æ•°æ˜¾ç¤ºé”™è¯¯** | å‰ç«¯ç¼“å­˜ | æ¸…é™¤æµè§ˆå™¨ç¼“å­˜æˆ–åˆ·æ–°é¡µé¢ |\n\n## ğŸ“ è·å–å¸®åŠ©\n\n- æŸ¥çœ‹åº”ç”¨æ—¥å¿—ï¼š`tail -f logs/app.log`\n- Kafka UIç®¡ç†ï¼šhttp://localhost:18080\n- InfluxDBæŸ¥è¯¢ï¼šhttp://localhost:8086\n- æ¶æ„æ–‡æ¡£ï¼šæŸ¥çœ‹ [ARCHITECTURE.md](ARCHITECTURE.md)\n\n````\n",
  "dependency_files": [
    "pom.xml",
    "src\\main\\resources\\application.yml"
  ],
  "docs_files": [],
  "entry_candidates": [],
  "java_analysis": {
    "java_file_count": 39,
    "java_files_sample": [
      "src\\main\\java\\com\\example\\kafka\\KafkaDemoApplication.java",
      "src\\main\\java\\com\\example\\kafka\\config\\InfluxDBConfig.java",
      "src\\main\\java\\com\\example\\kafka\\config\\KafkaConfig.java",
      "src\\main\\java\\com\\example\\kafka\\config\\WebSocketConfig.java",
      "src\\main\\java\\com\\example\\kafka\\consumer\\DataConsumer.java",
      "src\\main\\java\\com\\example\\kafka\\controller\\DatabaseController.java",
      "src\\main\\java\\com\\example\\kafka\\controller\\DataController.java",
      "src\\main\\java\\com\\example\\kafka\\controller\\DataQueryController.java",
      "src\\main\\java\\com\\example\\kafka\\controller\\HybridDataController.java",
      "src\\main\\java\\com\\example\\kafka\\controller\\InfluxDBMaintenanceController.java",
      "src\\main\\java\\com\\example\\kafka\\controller\\KafkaController.java",
      "src\\main\\java\\com\\example\\kafka\\controller\\WebSocketController.java",
      "src\\main\\java\\com\\example\\kafka\\datasource\\DataSource.java",
      "src\\main\\java\\com\\example\\kafka\\datasource\\FileDataSource.java",
      "src\\main\\java\\com\\example\\kafka\\datasource\\NetworkDataSource.java",
      "src\\main\\java\\com\\example\\kafka\\entity\\ChannelEntity.java",
      "src\\main\\java\\com\\example\\kafka\\entity\\OperationLogEntity.java",
      "src\\main\\java\\com\\example\\kafka\\entity\\PlcInterlockEntity.java",
      "src\\main\\java\\com\\example\\kafka\\entity\\ShotMetadataEntity.java",
      "src\\main\\java\\com\\example\\kafka\\entity\\WaveDataEntity.java",
      "src\\main\\java\\com\\example\\kafka\\ingest\\FileDataReader.java",
      "src\\main\\java\\com\\example\\kafka\\ingest\\NetworkDataReceiver.java",
      "src\\main\\java\\com\\example\\kafka\\model\\OperationLog.java",
      "src\\main\\java\\com\\example\\kafka\\model\\PlcInterlock.java",
      "src\\main\\java\\com\\example\\kafka\\model\\ShotMetadata.java",
      "src\\main\\java\\com\\example\\kafka\\model\\WaveData.java",
      "src\\main\\java\\com\\example\\kafka\\producer\\DataProducer.java",
      "src\\main\\java\\com\\example\\kafka\\repository\\ChannelRepository.java",
      "src\\main\\java\\com\\example\\kafka\\repository\\OperationLogRepository.java",
      "src\\main\\java\\com\\example\\kafka\\repository\\PlcInterlockRepository.java",
      "src\\main\\java\\com\\example\\kafka\\repository\\ShotMetadataRepository.java",
      "src\\main\\java\\com\\example\\kafka\\repository\\WaveDataRepository.java",
      "src\\main\\java\\com\\example\\kafka\\service\\DataPipelineService.java",
      "src\\main\\java\\com\\example\\kafka\\service\\DataQueryService.java",
      "src\\main\\java\\com\\example\\kafka\\service\\DataService.java",
      "src\\main\\java\\com\\example\\kafka\\service\\InfluxDBCleanupService.java",
      "src\\main\\java\\com\\example\\kafka\\service\\InfluxDBService.java",
      "src\\main\\java\\com\\example\\kafka\\service\\MessageConsumer.java",
      "src\\main\\java\\com\\example\\kafka\\service\\MessageProducer.java"
    ],
    "package_top20": [
      "com.example.kafka.controller",
      "com.example.kafka.service",
      "com.example.kafka.entity",
      "com.example.kafka.repository",
      "com.example.kafka.model",
      "com.example.kafka.config",
      "com.example.kafka.datasource",
      "com.example.kafka.ingest",
      "com.example.kafka",
      "com.example.kafka.consumer",
      "com.example.kafka.producer"
    ],
    "annotation_counts": {
      "Configuration": 4,
      "Service": 12,
      "KafkaListener": 12,
      "RestController": 7,
      "RequestMapping": 7,
      "GetMapping": 41,
      "PostMapping": 10,
      "Controller": 3,
      "Scheduled": 3,
      "Repository": 4
    },
    "controller_files": [
      "src/main/java/com/example/kafka/controller/DatabaseController.java",
      "src/main/java/com/example/kafka/controller/DataController.java",
      "src/main/java/com/example/kafka/controller/DataQueryController.java",
      "src/main/java/com/example/kafka/controller/HybridDataController.java",
      "src/main/java/com/example/kafka/controller/InfluxDBMaintenanceController.java",
      "src/main/java/com/example/kafka/controller/KafkaController.java",
      "src/main/java/com/example/kafka/controller/WebSocketController.java"
    ],
    "service_files": [
      "src/main/java/com/example/kafka/consumer/DataConsumer.java",
      "src/main/java/com/example/kafka/ingest/FileDataReader.java",
      "src/main/java/com/example/kafka/ingest/NetworkDataReceiver.java",
      "src/main/java/com/example/kafka/producer/DataProducer.java",
      "src/main/java/com/example/kafka/service/DataPipelineService.java",
      "src/main/java/com/example/kafka/service/DataQueryService.java",
      "src/main/java/com/example/kafka/service/DataService.java",
      "src/main/java/com/example/kafka/service/InfluxDBCleanupService.java",
      "src/main/java/com/example/kafka/service/InfluxDBService.java",
      "src/main/java/com/example/kafka/service/MessageConsumer.java",
      "src/main/java/com/example/kafka/service/MessageProducer.java"
    ],
    "repository_files": [
      "src/main/java/com/example/kafka/repository/ChannelRepository.java",
      "src/main/java/com/example/kafka/repository/OperationLogRepository.java",
      "src/main/java/com/example/kafka/repository/PlcInterlockRepository.java",
      "src/main/java/com/example/kafka/repository/ShotMetadataRepository.java",
      "src/main/java/com/example/kafka/repository/WaveDataRepository.java"
    ],
    "datasource_files": [
      "src/main/java/com/example/kafka/datasource/DataSource.java",
      "src/main/java/com/example/kafka/datasource/FileDataSource.java",
      "src/main/java/com/example/kafka/datasource/NetworkDataSource.java"
    ],
    "class_samples": [
      "BatchSyncResult",
      "ChannelEntity",
      "ChannelRepository",
      "CleanupReport",
      "DataConsumer",
      "DataController",
      "DataPipelineService",
      "DataProducer",
      "DataQueryController",
      "DataQueryService",
      "DataService",
      "DataSource",
      "DataSourceType",
      "DatabaseController",
      "FileDataReader",
      "FileDataSource",
      "HybridDataController",
      "InfluxDBCleanupService",
      "InfluxDBConfig",
      "InfluxDBMaintenanceController",
      "InfluxDBService",
      "KafkaConfig",
      "KafkaController",
      "KafkaDemoApplication",
      "MessageConsumer",
      "MessageProducer",
      "NetworkDataReceiver",
      "NetworkDataSource",
      "OperationLog",
      "OperationLogEntity",
      "OperationLogRepository",
      "PlcInterlock",
      "PlcInterlockEntity",
      "PlcInterlockRepository",
      "ShotCompleteData",
      "ShotMetadata",
      "ShotMetadataEntity",
      "ShotMetadataRepository",
      "SyncResult",
      "WaveData",
      "WaveDataEntity",
      "WaveDataRepository",
      "WebSocketConfig",
      "WebSocketController"
    ],
    "endpoint_samples": [
      "GET /api/data/channels",
      "GET /api/data/import/file/available",
      "GET /api/data/receive/status",
      "GET /api/data/shots",
      "GET /api/data/shots/{shotNo}/channels",
      "GET /api/data/shots/{shotNo}/complete",
      "GET /api/data/shots/{shotNo}/logs/operation",
      "GET /api/data/shots/{shotNo}/logs/plc",
      "GET /api/data/shots/{shotNo}/metadata",
      "GET /api/data/shots/{shotNo}/wave",
      "GET /api/data/status",
      "GET /api/database/logs",
      "GET /api/database/metadata",
      "GET /api/database/stats",
      "GET /api/database/tables",
      "GET /api/database/tables/{table}",
      "GET /api/database/wavedata",
      "GET /api/hybrid/shots",
      "GET /api/hybrid/shots/{shotNo}",
      "GET /api/hybrid/shots/{shotNo}/channels",
      "GET /api/hybrid/shots/{shotNo}/complete",
      "GET /api/hybrid/stats",
      "GET /api/hybrid/timeline/{shotNo}",
      "GET /api/hybrid/waveform",
      "GET /api/influxdb/cleanup",
      "GET /api/influxdb/integrity-report",
      "GET /api/kafka/batch",
      "GET /api/kafka/health",
      "GET /api/kafka/send",
      "GET /api/kafka/send-with-key",
      "GET /api/kafka/sync/batch",
      "GET /api/kafka/sync/shot",
      "POST /api/data/import/file/all",
      "POST /api/data/import/file/{shotNo}",
      "POST /api/data/receive/metadata",
      "POST /api/data/receive/operation",
      "POST /api/data/receive/plc",
      "POST /api/data/receive/wave",
      "POST /api/data/shots/batch-metadata",
      "POST /api/data/source/switch",
      "POST /api/influxdb/fix-all",
      "POST /api/kafka/sync/all"
    ],
    "kafka_topics": [
      "shot-metadata",
      "wave-data",
      "operation-log",
      "plc-interlock"
    ],
    "core_classes": [
      "DataConsumer",
      "DataPipelineService",
      "DataProducer",
      "FileDataSource",
      "InfluxDBService",
      "KafkaController",
      "NetworkDataSource",
      "WebSocketController"
    ],
    "keyword_hits": {
      "InfluxDB": 6,
      "WebSocket": 3,
      "KafkaListener": 4,
      "MySQL": 4,
      "syncShotToKafka": 2,
      "syncAllShotsToKafka": 2,
      "fallback": 1
    }
  },
  "feature_flags": {
    "dual_data_source": true,
    "kafka_pipeline": true,
    "hybrid_storage_mysql_influx": true,
    "rest_api": true,
    "websocket_push": true,
    "scheduled_task": true,
    "fallback_switching": true
  },
  "technical_points": [
    "ä¸»å¤‡åŒæ•°æ®æºæ¥å…¥ä¸è¿è¡Œæ—¶åˆ‡æ¢æœºåˆ¶",
    "æ–‡ä»¶/ç½‘ç»œæ•°æ®ç»æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œå¼‚æ­¥è§£è€¦å¤„ç†",
    "ç»“æ„åŒ–æ•°æ®ä¸æ—¶åºæ•°æ®åˆ†å±‚å­˜å‚¨",
    "åŸºäºRESTæ¥å£çš„æ•°æ®æŸ¥è¯¢ä¸åŒæ­¥è§¦å‘",
    "é¢å‘å‰ç«¯å±•ç¤ºçš„å®æ—¶æ¨é€æœºåˆ¶",
    "å®šæ—¶ä»»åŠ¡é©±åŠ¨çš„æ•°æ®åŒæ­¥ç­–ç•¥"
  ]
}